{"ast":null,"code":"import { calculateAngle } from '../utils/formulas';\nimport createFlyingObjects from './createFlyingObjects';\nimport moveBalls from './moveCannonBalls';\nimport checkCollisions from './checkCollisions';\nfunction moveObjects(state, action) {\n  if (!state.gameState.started) return state;\n  let cannonBalls = moveBalls(state.gameState.cannonBalls);\n  const mousePosition = action.mousePosition || {\n    x: 0,\n    y: 0\n  };\n  const newState = createFlyingObjects(state);\n  const now = new Date().getTime();\n  let flyingObjects = newState.gameState.flyingObjects.filter(object => now - object.createdAt < 3000);\n  const lostLife = state.gameState.flyingObjects.length > flyingObjects.length;\n  let lives = state.gameState.lives;\n  if (lostLife) {\n    lives--;\n  }\n  const started = lives > 0;\n  if (!started) {\n    flyingObjects = [];\n    cannonBalls = [];\n    lives = 3;\n  }\n  const {\n    x,\n    y\n  } = mousePosition;\n  const angle = calculateAngle(0, 0, x, y);\n  const objectsDestroyed = checkCollisions(cannonBalls, flyingObjects);\n  const cannonBallsDestroyed = objectsDestroyed.map(object => object.cannonBallId);\n  const flyingDiscsDestroyed = objectsDestroyed.map(object => object.flyingDiscId);\n  cannonBalls = cannonBalls.filter(cannonBall => cannonBallsDestroyed.indexOf(cannonBall.id));\n  flyingObjects = flyingObjects.filter(flyingDisc => flyingDiscsDestroyed.indexOf(flyingDisc.id));\n  const kills = state.gameState.kills + flyingDiscsDestroyed.length;\n  return {\n    ...newState,\n    gameState: {\n      ...newState.gameState,\n      flyingObjects,\n      cannonBalls: [...cannonBalls],\n      lives,\n      started,\n      kills\n    },\n    angle\n  };\n}\nexport default moveObjects;","map":{"version":3,"names":["calculateAngle","createFlyingObjects","moveBalls","checkCollisions","moveObjects","state","action","gameState","started","cannonBalls","mousePosition","x","y","newState","now","Date","getTime","flyingObjects","filter","object","createdAt","lostLife","length","lives","angle","objectsDestroyed","cannonBallsDestroyed","map","cannonBallId","flyingDiscsDestroyed","flyingDiscId","cannonBall","indexOf","id","flyingDisc","kills"],"sources":["C:/Users/dibya/OneDrive/Desktop/VS code/aliens-go-home/src/reducers/moveObjects.js"],"sourcesContent":["import { calculateAngle } from '../utils/formulas';\r\nimport createFlyingObjects from './createFlyingObjects';\r\nimport moveBalls from './moveCannonBalls';\r\nimport checkCollisions from './checkCollisions';\r\n\r\nfunction moveObjects(state, action) {\r\n  if (!state.gameState.started) return state;\r\n\r\n  let cannonBalls = moveBalls(state.gameState.cannonBalls);\r\n\r\n  const mousePosition = action.mousePosition || {\r\n    x: 0,\r\n    y: 0,\r\n  };\r\n\r\n  const newState = createFlyingObjects(state);\r\n\r\n  const now = (new Date()).getTime();\r\n  let flyingObjects = newState.gameState.flyingObjects.filter(object => (\r\n    (now - object.createdAt) < 3000\r\n  ));\r\n\r\n  const lostLife = state.gameState.flyingObjects.length > flyingObjects.length;\r\n  let lives = state.gameState.lives;\r\n  if (lostLife) {\r\n    lives--;\r\n  }\r\n\r\n  const started = lives > 0;\r\n  if (!started) {\r\n    flyingObjects = [];\r\n    cannonBalls = [];\r\n    lives = 3;\r\n  }\r\n\r\n  const { x, y } = mousePosition;\r\n  const angle = calculateAngle(0, 0, x, y);\r\n\r\n  const objectsDestroyed = checkCollisions(cannonBalls, flyingObjects);\r\n  const cannonBallsDestroyed = objectsDestroyed.map(object => (object.cannonBallId));\r\n  const flyingDiscsDestroyed = objectsDestroyed.map(object => (object.flyingDiscId));\r\n\r\n  cannonBalls = cannonBalls.filter(cannonBall => (cannonBallsDestroyed.indexOf(cannonBall.id)));\r\n  flyingObjects = flyingObjects.filter(flyingDisc => (flyingDiscsDestroyed.indexOf(flyingDisc.id)));\r\n\r\n  const kills = state.gameState.kills + flyingDiscsDestroyed.length;\r\n\r\n  return {\r\n    ...newState,\r\n    gameState: {\r\n      ...newState.gameState,\r\n      flyingObjects,\r\n      cannonBalls: [...cannonBalls],\r\n      lives,\r\n      started,\r\n      kills,\r\n    },\r\n    angle,\r\n  };\r\n}\r\n\r\nexport default moveObjects;"],"mappings":"AAAA,SAASA,cAAc,QAAQ,mBAAmB;AAClD,OAAOC,mBAAmB,MAAM,uBAAuB;AACvD,OAAOC,SAAS,MAAM,mBAAmB;AACzC,OAAOC,eAAe,MAAM,mBAAmB;AAE/C,SAASC,WAAWA,CAACC,KAAK,EAAEC,MAAM,EAAE;EAClC,IAAI,CAACD,KAAK,CAACE,SAAS,CAACC,OAAO,EAAE,OAAOH,KAAK;EAE1C,IAAII,WAAW,GAAGP,SAAS,CAACG,KAAK,CAACE,SAAS,CAACE,WAAW,CAAC;EAExD,MAAMC,aAAa,GAAGJ,MAAM,CAACI,aAAa,IAAI;IAC5CC,CAAC,EAAE,CAAC;IACJC,CAAC,EAAE;EACL,CAAC;EAED,MAAMC,QAAQ,GAAGZ,mBAAmB,CAACI,KAAK,CAAC;EAE3C,MAAMS,GAAG,GAAI,IAAIC,IAAI,EAAE,CAAEC,OAAO,EAAE;EAClC,IAAIC,aAAa,GAAGJ,QAAQ,CAACN,SAAS,CAACU,aAAa,CAACC,MAAM,CAACC,MAAM,IAC/DL,GAAG,GAAGK,MAAM,CAACC,SAAS,GAAI,IAC5B,CAAC;EAEF,MAAMC,QAAQ,GAAGhB,KAAK,CAACE,SAAS,CAACU,aAAa,CAACK,MAAM,GAAGL,aAAa,CAACK,MAAM;EAC5E,IAAIC,KAAK,GAAGlB,KAAK,CAACE,SAAS,CAACgB,KAAK;EACjC,IAAIF,QAAQ,EAAE;IACZE,KAAK,EAAE;EACT;EAEA,MAAMf,OAAO,GAAGe,KAAK,GAAG,CAAC;EACzB,IAAI,CAACf,OAAO,EAAE;IACZS,aAAa,GAAG,EAAE;IAClBR,WAAW,GAAG,EAAE;IAChBc,KAAK,GAAG,CAAC;EACX;EAEA,MAAM;IAAEZ,CAAC;IAAEC;EAAE,CAAC,GAAGF,aAAa;EAC9B,MAAMc,KAAK,GAAGxB,cAAc,CAAC,CAAC,EAAE,CAAC,EAAEW,CAAC,EAAEC,CAAC,CAAC;EAExC,MAAMa,gBAAgB,GAAGtB,eAAe,CAACM,WAAW,EAAEQ,aAAa,CAAC;EACpE,MAAMS,oBAAoB,GAAGD,gBAAgB,CAACE,GAAG,CAACR,MAAM,IAAKA,MAAM,CAACS,YAAa,CAAC;EAClF,MAAMC,oBAAoB,GAAGJ,gBAAgB,CAACE,GAAG,CAACR,MAAM,IAAKA,MAAM,CAACW,YAAa,CAAC;EAElFrB,WAAW,GAAGA,WAAW,CAACS,MAAM,CAACa,UAAU,IAAKL,oBAAoB,CAACM,OAAO,CAACD,UAAU,CAACE,EAAE,CAAE,CAAC;EAC7FhB,aAAa,GAAGA,aAAa,CAACC,MAAM,CAACgB,UAAU,IAAKL,oBAAoB,CAACG,OAAO,CAACE,UAAU,CAACD,EAAE,CAAE,CAAC;EAEjG,MAAME,KAAK,GAAG9B,KAAK,CAACE,SAAS,CAAC4B,KAAK,GAAGN,oBAAoB,CAACP,MAAM;EAEjE,OAAO;IACL,GAAGT,QAAQ;IACXN,SAAS,EAAE;MACT,GAAGM,QAAQ,CAACN,SAAS;MACrBU,aAAa;MACbR,WAAW,EAAE,CAAC,GAAGA,WAAW,CAAC;MAC7Bc,KAAK;MACLf,OAAO;MACP2B;IACF,CAAC;IACDX;EACF,CAAC;AACH;AAEA,eAAepB,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}